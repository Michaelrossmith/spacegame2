@using Microsoft.JSInterop
@inject IJSRuntime JSRuntime

<canvas @ref="canvasRef" width="400" height="400" style="width: 100%; height: 100%; image-rendering: crisp-edges;"></canvas>

@code {
    [Parameter] public string ObjectType { get; set; } = "planet";
    [Parameter] public string ObjectId { get; set; } = "default";
    [Parameter] public string ObjectShape { get; set; } = "sphere";
    [Parameter] public double SlicePosition { get; set; } = 0.0;
    
    private ElementReference canvasRef;
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await GenerateCrossSection();
        }
    }
    
    protected override async Task OnParametersSetAsync()
    {
        if (canvasRef.Id != null)
        {
            await GenerateCrossSection();
        }
    }
    
    private async Task GenerateCrossSection()
    {
        await JSRuntime.InvokeVoidAsync("generateCrossSection", canvasRef, ObjectType, ObjectId, ObjectShape, SlicePosition);
    }
}